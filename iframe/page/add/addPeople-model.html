<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>添加项目模块人员</title>
    <link rel="stylesheet" href="../../assets/libs/layui/css/layui.css"/>
    <link rel="stylesheet" href="../../assets/module/admin.css?v=312"/>
    <link rel="stylesheet" href="../../assets/module/dtree/dtree.css" media="all">
    <link rel="stylesheet" href="../../assets/module/dtree/font/dtreefont.css" media="all">
    <link rel="stylesheet" href="../../assets/module/eleTree/eleTree.css">
    <style>
        #export-pin .layui-form-item {
            margin-bottom: 0;
            margin-top: 20px;
        }

        #export-pin .layui-form-item .layui-inline {
            margin-bottom: 25px;
            margin-right: 0;
        }

        .form-group-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            padding: 10px 20px;
            box-shadow: 0 -1px 2px 0 rgba(0, 0, 0, .05);
        }
        .layui-form-label{
            padding: 9px 0px;
            width: 66px;
        }
        .layui-input-block{
            margin-left: 80px;
        }
    </style>
</head>
<body>

<!-- 正文开始 -->
<form class="layui-form" lay-filter="Export-pin" id="export-pin">
    <div class="layui-fluid" style="padding-bottom: 75px;">

        <!--        模块选择-->
        <div class="layui-card">
<!--                        <div class="layui-card-header">模块选择</div>-->
            <div class="layui-card-body">

                <div class="layui-form-item layui-row">
                    <div class="layui-inline layui-col-md12">
                        <label class="layui-form-label">所属模块 :</label>
                        <div class="layui-input-block">
                            <select name="productCategory" lay-verify="required" lay-verify="productCategory">
                                <option value=""></option>
                                <option value="业务模块" selected="">业务模块</option>
                                <option value="计划模块">计划模块</option>
                                <option value="质量模块">质量模块</option>
                                <option value="工程模块">工程模块</option>
                                <option value="生产模块">生产模块</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--        部门选择-->
        <div class="layui-card">
<!--            <div class="layui-card-header">部门选择</div>-->
            <div class="layui-card-body">

                <div class="layui-form-item layui-row">
                    <div class="layui-inline layui-col-md12">
                        <label class="layui-form-label">所属部门 :</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required="" lay-verify="required" placeholder="请选择部门" readonly="" autocomplete="off" class="layui-input">
                            <div class="eleTree ele5" lay-filter="data5" style="display: none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--        人员选择-->
        <div class="layui-card">
<!--                        <div class="layui-card-header">人员选择</div>-->
            <div class="layui-card-body">
                <div class="layui-form-item layui-row">
                    <div class="layui-inline layui-col-md12">
                        <label class="layui-form-label">人员选择 :</label>
                        <div class="layui-input-block">
                            <select name="productCategory" lay-filter="productCategoryChoice" lay-verify="required">
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--        备注-->
        <div class="layui-card">
<!--                        <div class="layui-card-header">职责负责</div>-->
            <div class="layui-card-body">
                <div class="layui-form-item layui-row">
                    <div class="layui-inline layui-col-md12">
                        <label class="layui-form-label">职责负责 :</label>
                        <div class="layui-input-block">
                            <textarea placeholder="请输入内容" class="layui-textarea" lay-verify="required"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group-bottom text-right" style="margin: 0 auto; width: 96%;">
        <button type="reset" class="layui-btn layui-btn-primary">&emsp;重置&emsp;</button>
        <button class="layui-btn" lay-filter="formSubmitAdv" lay-submit>&emsp;提交&emsp;</button>
    </div>

</form>
<!-- js部分 -->
<script type="text/javascript" src="../../assets/libs/layui/layui.js"></script>
<script type="text/javascript" src="../../assets/js/common.js?v=312"></script>

<script>
    layui.use(['layer', 'form', 'table', 'util', 'laydate','admin','dtree','treeSelect','jquery','eleTree'], function () {
        var $ = layui.jquery;
        var layer = layui.layer;
        var form = layui.form;
        var table = layui.table;
        var util = layui.util;
        var laydate = layui.laydate;
        var admin = layui.admin;
        var dtree = layui.dtree;
        var treeSelect = layui.treeSelect;
        var eleTree = layui.eleTree;

        // var libinglin = null;
        $.ajax({
            type: "GET",
            headers:{
                "token":'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VyVG9rZW4iOiJ7XCJpZFwiOjUxLFwibmFtZVwiOlwibGliaW5nbGluXCIsXCJjb2RlXCI6XCJza3kyMDYxOTNcIixcImZpbHRlclwiOm51bGx9In0.ARKC424DcHGGTTQiiO7V6HVCq5Zj1yBMu2JHZTbKjjs'
            },
            // url: "http://172.20.248.220:8088/dms/safe_usercenter/safe/department/getDepartmentTree",
            url:"https://www.easy-mock.com/mock/5cf1600306cab27e589f9550/safe_usercenter/safe/department/getDepartmentTree",
            success: function (res) {
                // console.log(res);
                    libinglin = res;
                // 将res对象转换成json对象
                // var resjson = $.parseJSON(res)
                // 初始化树
                eleTree.render({
                    elem: '.ele5',
                    data: [res],
                    defaultExpandAll: true,
                    expandOnClickNode: false,
                    highlightCurrent: true,
                    request: {
                        name: "text",
                        key: "id",
                        children: "children",
                        checked: "checked",
                        disabled: "disabled",
                        isLeaf: "isLeaf"
                    },
                    showLine:true
                });
            }
        });
        var clickstatus = false;
        $("[name='title']").on("mouseover",function (e) {
            $(this).css("cursor","pointer")
        });
        $("[name='title']").on("click",function (e) {
            e.stopPropagation();
            if (clickstatus == false){
                $(".ele5").slideDown(300);
                clickstatus = true;
            } else{
                $(".ele5").slideUp(300);
                clickstatus = false;
            }

        });
        eleTree.on("nodeClick(data5)",function(d) {
            console.log(d);
            $("[name='title']").val(d.data.currentData.text);
            $(".ele5").hide();
            clickstatus = false;
        });
        $(document).on("click",function() {
            $(".ele5").hide();
            clickstatus = false;
        })
    });
</script>
</body>

</html>